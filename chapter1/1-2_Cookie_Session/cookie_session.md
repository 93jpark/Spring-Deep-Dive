# 배경

HTTP는 브라우저와 서버 간 데이터를 주고 받기 위해 사용되는 프로토콜.

## HTTP의 특징

- connectionless(비연결성)
    HTTP 요청에 대한 응답 통신 이후 연결을 끊는다.

- stateless(무상태성)
    연결이 종료되면 통신에 대한 상태를 유지하지 않는다.

## Persistence?

`그렇다면 인증/인가를 위한 유저 정보 및 기타 상태는 어떻게?`
로그인 정보 및 상태, 장바구니, 팝업창 닫기는 어떻게 처리해야 하나? HTTP의 특징에 따르면, 사용자는 브라우저를 통해 페이지를 이동할때마다 재로그인과정을 겪어야 하며, 장바구니와 같은 데이터를 저장해둘수없으며, 페이지 이동할때마다 매번 팝업창이 뜨게 될것이다.
이러한 문제를 해결하기 위해 `쿠키`와 `세션`기술이 소개되었다.

<br>

---

<br>


# 쿠키
`쿠키` 서버가 사용자의 웹 브라우저에 전송하는 데이터 조각. 브라우저는 해당 데이터를 저장하고, 동일한 서버에 재요청 시 저장된 데이터를 함께 전송.<br>

쿠키에 대해 유효기간 지정을 할 수 있으며, 유효기간 내에서는 브라우저가 종료되더라도 데이터가 유지된다.

요청 시 헤더에 자동으로 포함되어 서버로 전송된다.

## 쿠키의 구성 요소
- 이름: 쿠키를 구별하는데에 사용되는 이름
- 값: 쿠키 이름에 해당하는 데이터 값
- 유효기간: 쿠키 유효기간
- 도메인: 쿠키를 전송한 도메인
- 경로: 쿠키를 전송할 요청 경로

```HTTP
HTTP/1.1 200 OK
Set-Cookie: 
name=cookie1;
Expires=Wed, 21 Oct 2022 09:00:00 GMT; 
Domain: abc.com; 
Path=/

GET /index.html HTTP/1.1
Cookie: name=cookie1
```

## 쿠키의 동작 과정
1. 클라이언트가 페이지를 요청
2. 서버는 쿠키를 생성한 후 헤더에 포함하여 응답 전송
3. 클라이언트는 응답으로 전송 받은 쿠키를 로컬에 저장
4. 클라이언트에서 요청을 보낼 때 헤더에 쿠키를 포함시켜 전송

<br>

---

<br>

# 세션
`세션` 일정기간동안 클라이언트로부터 받은 요청을 하나의 상태로 간주하여 해당 정보를 유지시키는 기술. 여기서 일정기간은 클라이언트가 어플리케이션을 종료하여 연결을 끝내는 시점을 말한다.
세션은 쿠키를 기반으로 하지만, 데이터를 저장/관리하는 주체는 서버이다.

## 세션의 특징
클라이언트를 구분하기 위해 ID를 부여하며, 서버에 접속하여 연결을 종료할때까지 인증상태를 유지한다.

세션 ID를 통해 클라이언트를 구분해 요청에 대해 커스텀된 서비스를 제공한다.

쿠키보다 보안적으로 우수하지만 서버 메모리와 별도의 DB를 사용하기에 리소스 낭비가 발생한다.

## 세션의 동작 과정
1. 클라이언트으로부터 페이지 요청
2. 서버는 요청의 헤더에서 쿠키를 통해 세션ID 확인
3. 세션ID가 없다면 생성 후 클라이언트에게 전송
4. 클라이언트는 전송받은 세션ID를 저장하고 재요청하여 세션정보를 재전송
5. 서버는 세션ID에 따른 서비스 제공

```HTTP
HTTP/1.1 200 OK
Set-Cookie: 
JSESSIONIDe=dieknd21m24diek3idknbl;

GET /index.html HTTP/1.1
Cookie: JSESSIONID=dieknd21m24diek3idknbl;
```